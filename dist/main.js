!function(){"use strict";function c(e,t){var n=document.createElement(e||"div");for(var o in t){var i=t[o];if(null!=i)if("dataset"===o)for(var l in i){var a=i[l];null!=a&&(n.dataset[l]=a)}else if("style"===o)if("string"==typeof i)n.style.cssText=i;else for(var r in i){var d=i[r];null!=d&&(n.style[r]=d)}else o in n||"function"==typeof i?!0===(n[o]=i)&&n.setAttribute(o.toLowerCase(),""):n.setAttribute(o,i)}for(var s=arguments.length,u=new Array(2<s?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];return function t(n,e){e.forEach(function(e){null!=e&&(e.nodeType?n.appendChild(e):"string"==typeof e||"number"==typeof e?n.appendChild(document.createTextNode(e)):e.length&&t(n,e))})}(n,u),n}var r=1;function h(e,t){if(e.nodeType===t.nodeType)if(e.nodeType===r){if(i=t,l=(o=e).getAttribute("data-domsame"),a=i.getAttribute("data-domsame"),l&&a&&l===a||i.isSameNode(o))return;if(function(e,t){var n={},o=e.firstChild;for(;o;){var i=o;o=o.nextSibling;var l=p(i);l&&(n[l]=i)}o=e.firstChild;var a=t.firstChild,r=0;for(;a;){r+=1;var d=a;a=a.nextSibling;var s=p(d),u=s?n[s]:null;if(u)delete n[s],u===o?o=o.nextSibling:e.insertBefore(u,o),h(u,d);else if(o){var c=o;o=o.nextSibling,m(n,c)?e.insertBefore(d,c):h(c,d)}else e.appendChild(d)}for(var f in n)e.removeChild(n[f]);var v=e.childNodes.length-r;for(;0<=--v;)e.removeChild(e.lastChild)}(e,t),e.nodeName===t.nodeName)!function(e,t){for(var n=e.attributes,o=n.length-1;0<=o;o-=1){var i=n[o],l=i.namespaceURI,a=i.localName;t.hasAttributeNS(l,a)||e.removeAttributeNS(l,a)}for(var r=t.attributes,d=r.length-1;0<=d;d-=1){var s=r[d],u=s.namespaceURI,c=s.localName,f=t.getAttributeNS(u,c),v=e.getAttributeNS(u,c);f!==v&&e.setAttributeNS(u,c,f)}var h=e.nodeName;if("INPUT"===h){g(e,t,"checked"),g(e,t,"disabled"),g(e,t,"readOnly");var p=t.value;e.value!==p&&(e.value=p),t.hasAttributeNS(null,"value")||e.removeAttribute("value")}else if("TEXTAREA"===h){g(e,t,"disabled"),g(e,t,"readOnly");var m=t.value;e.value!==m&&(e.value=m)}else"OPTION"===h?(g(e,t,"selected"),g(e,t,"disabled")):"SELECT"===h&&g(e,t,"disabled")}(e,t);else{for(var n=t.cloneNode();e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e)}}else e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue);else e.parentNode.replaceChild(t,e);var o,i,l,a}function g(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n.toLowerCase(),""):e.removeAttribute(n.toLowerCase()))}function p(e){if(e.nodeType===r)return e.getAttribute("data-domkey")}function m(e,t){for(var n in e)if(e[n]===t)return!0;return!1}var f={all:function(e){return e},active:function(e){return e.filter(function(e){return!e.done})},done:function(e){return e.filter(function(e){return e.done})}};function v(e,t,n){if(e.target.dataset.editing){var o=e.target.value,i=o&&o.trim();i?t.emit("update",{todo:n,title:i}):t.emit("remove",{todo:n})}}var b,o,i,e=window.localStorage,t="js-todo";!function(t,n,o){n.on("add",function(e){t.add(e.title),o(t,n)}).on("update",function(e){t.update(e.todo,e.title),t.editTodo=null,o(t,n)}).on("remove",function(e){t.remove(e.todo),t.editTodo=null,o(t,n)}).on("removeDones",function(e){t.removeDones(),o(t,n)}).on("toggle",function(e){t.toggle(e.todo),o(t,n)}).on("toggleAll",function(e){t.toggleAll(),o(t,n)}).on("startEdit",function(e){t.editTodo=e.todo,o(t,n)}).on("cancelEdit",function(e){t.editTodo=null,o(t,n)});var i,l,a,e=(i=t,l=n,a=o,function(){var e=window.location.hash.replace(/#\/?/,"");f[e]?i.visibility=e:(window.location.hash="",i.visibility="all"),a(i,l)});window.addEventListener("hashchange",e),t.load(),e()}({todos:[],editTodo:null,visibility:null,load:function(){this.todos=JSON.parse(e.getItem(t)||"[]")},save:function(){e.setItem(t,JSON.stringify(this.todos))},add:function(e){var t=e&&e.trim();t&&(this.todos.push({id:Date.now(),title:t,done:!1}),this.save())},update:function(e,t){t&&(e.title=t,this.save())},remove:function(t){this.todos=this.todos.filter(function(e){return e.id!==t.id}),this.save()},removeDones:function(){this.todos=f.active(this.todos),this.save()},toggle:function(e){e.done=!e.done,this.save()},toggleAll:function(){var t=f.done(this.todos).length===this.todos.length;this.todos.forEach(function(e){return e.done=!t}),this.save()}},(o=Object.create(null),i={on:function(e,t){return o[e]||(o[e]=[]),o[e].push(t),i},off:function(e,t){if(o[e])if(null==t)o[e]=[];else{var n=o[e].indexOf(t);0<=n&&o[e].splice(n,1)}return i},emit:function(e,t){return o[e]&&o[e].forEach(function(e){return e(t)}),i}}),(b=document.getElementById("app"),function(e,t){var n,l,o,a,i,r,d,s=(l=t,o=(n=e).todos,a=n.editTodo,i=n.visibility,r=f.active(o).length,d=f[i](o),c("div",{class:"panel"},c("div",{class:"panel-heading"},"Todos"),c("div",{class:"panel-block",dataset:{domsame:"newTodo"}},c("input",{class:"input",type:"text",placeholder:"What needs to be done?",autofocus:!0,onkeyup:function(e){return function(e,t){if("Enter"===e.key){var n=e.target.value;e.target.value="",t.emit("add",{title:n})}}(e,l)}})),c("div",{class:"panel-tabs"},c("a",{class:"all"===i?"is-active":null,href:"#/all"},"All"),c("a",{class:"active"===i?"is-active":null,href:"#/active"},"Active"),c("a",{class:"done"===i?"is-active":null,href:"#/done"},"Done")),c("label",{class:"panel-block",style:o.length?null:"display:none"},c("input",{type:"checkbox",checked:o.every(function(e){return e.done}),onchange:function(e){return l.emit("toggleAll")}}),"Mark all as done"),d.map(function(i){return c("div",{class:"panel-block todo-item",dataset:{domkey:"todo-"+i.id}},c("div",{style:i!==a?null:"display:none"},c("input",{type:"checkbox",checked:i.done,onchange:function(e){return l.emit("toggle",{todo:i})}}),c("label",{class:"todo"+(i.done?" done":""),ondblclick:function(e){return l.emit("startEdit",{todo:i})}},i.title)),c("button",{class:"delete",style:i!==a?null:"display:none",onclick:function(e){return l.emit("remove",{todo:i})}}),c("input",{class:"input",style:i===a?null:"display:none",type:"text",value:a?a.title:null,dataset:{editing:i===a?"*":null},onblur:function(e){return v(e,l,i)},onkeyup:function(e){return n=l,o=i,void("Enter"===(t=e).key?v(t,n,o):"Escape"===t.key&&n.emit("cancelEdit",{}));var t,n,o}}))}),c("div",{class:"panel-block",style:o.length?null:"display:none"},c("strong",{},r),1===r?" item left":" items left"),c("div",{class:"panel-block",style:o.length>r?null:"display:none"},c("button",{class:"button is-link is-fullwidth",onclick:function(e){return l.emit("removeDones")}},"Clear done")))),u=b.lastChild;u?h(u,s):b.appendChild(s)}))}();
